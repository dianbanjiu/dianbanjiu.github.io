<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>蓝牙 on 点半九</title><link>https://blog.djangozane.com/tags/%E8%93%9D%E7%89%99/</link><description>Recent content in 蓝牙 on 点半九</description><generator>Hugo -- gohugo.io</generator><language>en</language><lastBuildDate>Mon, 16 Sep 2019 13:30:06 +0800</lastBuildDate><atom:link href="https://blog.djangozane.com/tags/%E8%93%9D%E7%89%99/index.xml" rel="self" type="application/rss+xml"/><item><title>Linux 下蓝牙鼠标延迟严重</title><link>https://blog.djangozane.com/post/linux-%E4%B8%8B%E8%93%9D%E7%89%99%E9%BC%A0%E6%A0%87%E5%BB%B6%E8%BF%9F%E4%B8%A5%E9%87%8D/</link><pubDate>Mon, 16 Sep 2019 13:30:06 +0800</pubDate><guid>https://blog.djangozane.com/post/linux-%E4%B8%8B%E8%93%9D%E7%89%99%E9%BC%A0%E6%A0%87%E5%BB%B6%E8%BF%9F%E4%B8%A5%E9%87%8D/</guid><description>&lt;p&gt;最近买了一个小米便携蓝牙鼠标，在 Arch Linux 下成功连接上鼠标之后，发现鼠标的延迟特别严重，但是鼠标连接到手机上却十分顺滑，由此基本断定是在 Arch Linux 上的某些配置导致的这些问题。&lt;/p&gt;
&lt;h3 id="解决办法"&gt;解决办法&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;断开并重新连接鼠标。（无效）&lt;/li&gt;
&lt;li&gt;断开其他的外设，如无线键盘（使用 2.4GHZ 的无线接收器），断开 wifi（包括 2.4GHZ 和 5GHZ 的频段）。（无效）&lt;/li&gt;
&lt;li&gt;修改鼠标轮询率（Mouse polling rate ）。（丝般顺滑）&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;在系统的蓝牙设备管理器当中查看当前蓝牙鼠标的地址，地址字段类似于 &lt;code&gt;D3:77:66:C8:FE:53&lt;/code&gt;。然后在超级用户的状态下修改 &lt;code&gt;/var/lib/bluetooth/&amp;lt;mac-of-your-adapter&amp;gt;/&amp;lt;mac-of-your-mouse&amp;gt;/info&lt;/code&gt;，添加以下字段：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;一般情况，系统上只有一个蓝牙适配器，&lt;code&gt;&amp;lt;mac-of-your-adapter&amp;gt;&lt;/code&gt; 是可以直接使用 Tab 键来补全的，你只需要根据之前查看到的蓝牙鼠标地址替换掉 &lt;code&gt;&amp;lt;mac-of-your-mouse&amp;gt;&lt;/code&gt; 就可以了。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;[ConnectionParameters]
MinInterval=6
MaxInterval=9
Latency=44
Timeout=216
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;通常 Linux 下的蓝牙设备是不会自动连接的，可以通过在 &lt;code&gt;/etc/bluetooth/main.conf&lt;/code&gt; 的 &lt;code&gt;[Policy]&lt;/code&gt; 下添加 &lt;code&gt;AutoEnable=true&lt;/code&gt; 将蓝牙设备设置为开机自动连接。&lt;/p&gt;
&lt;h3 id="关于轮询率和轮询间隔"&gt;关于轮询率和轮询间隔&lt;/h3&gt;
&lt;p&gt;设备的轮询率（单位 Hz）取决于轮询间隔，轮询间隔以毫秒为单位进行测量，等于滞后时间。&lt;/p&gt;
&lt;p&gt;默认的轮询间隔一般为 10ms，但是 USB 控制器一般会向下取最近的 2 的整数次幂，所以 10ms 的轮询时间实际上是 8ms 的轮询时间。&lt;/p&gt;
&lt;p&gt;下面是几个常用轮询率与轮询间隔的对应表（速率 = 1000/轮询间隔）：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;轮询率（Hz）&lt;/th&gt;
&lt;th&gt;1000&lt;/th&gt;
&lt;th&gt;500&lt;/th&gt;
&lt;th&gt;250&lt;/th&gt;
&lt;th&gt;125&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;轮询间隔（ms）&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;8&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;如果是进行一些精度较高的活动时，可以把轮询间隔尽可能地调得小一些，不过这么做同时也会加重 CPU 的负担。&lt;/p&gt;</description></item></channel></rss>